# Internet 地址结构

## 表示IP地址

- IPv4
  - 长度：32位
  - 表示法：点分四组
  - 地址数量：4,294,967,296
- IPv6
  - 长度：128位，IPv4地址长度的四倍
  - 表示法：32位十六进制数
  - 地址数量：340,282,366,920,938,463,463,374,607,431,768,211,456

- IPv4地址分类

  - ![image-20210904101657034](https://i.loli.net/2021/10/12/KFcMeQ1qWrUTABj.png)

  - A、B、C类用于为 单播地址中的接口分配地址，以及其他一些特殊情况下使用

  - | 类   | 地址范围                    | 高序位 | 用途      | 百分比 | 网络数  | 主机数     |
    | ---- | --------------------------- | ------ | --------- | ------ | ------- | ---------- |
    | A    | 0.0.0.0 ~ 127.255.255.255   | 0      | 单播/特殊 | 1/2    | 128     | 16,777,216 |
    | B    | 128.0.0.0 ~ 191.255.255.255 | 10     | 单播/特殊 | 1/4    | 16384   | 65536      |
    | C    | 192.0.0.0 ~ 223.255.255.255 | 11     | 单播/特殊 | 1/8    | 2097152 | 256        |
    | D    | 224.0.0.0 ~ 239.255.255.255 | 1110   | 组播      | 1/16   | N/A     | N/A        |
    | E    | 240.0.0.0 ~ 255.255.255.255 | 1111   | 保留      | 1/16   | N/A     | N/A        |

  - 地址块中的第一个和最后一个通常不使用

    - 如 18.0.0.0，实际能分配 $2^{24}-2$ 个单播地址

### 广播地址

- 子网广播地址，将IPv4地址的网络/子网部分设置为适当值，主机部分的所有位设置为1
- <img src="https://i.loli.net/2021/10/12/jERItOes4fQydCX.png" alt="image-20210904103641320" style="zoom:50%;" />
- 子网128.32.1.0/24 的子网广播地址为 128.32.1.255
- 使用这种地址作为目的地的数据报，也被称为定向广播
  - 这种广播可以作为一个单独的数据报，通过Internet 路由直至到达目标子网
  - 再作为一组广播数据报发送给子网中所有主机
  - 从安全角度看，定向广播在 Internet中被禁用
- 本地网络广播（有限广播）
  - 255.255.255.255
  - 不会被路由器转发
  - 虽然路由器可能不会转发广播，但是子网广播和连接在同一网络中的计算机的本地网络广播将工作，除非被终端主机明确禁用
  - 这种广播不需要路由器
  - 链路层的广播机制将用于支持它们



### IPv6地址和接口标识符

- IPv6地址使用特殊的前缀表示一个地址范围
  - 一个IPv6地址范围指它可用的网络规模
  - 有关范围的重要例子包括
    - 节点本地（只用于同一计算机中通信）
    - 链路本地（只用于同一网络链路或IPv6前缀中的结点）
    - 全球性（Internet 范围）
  - IPv6中，大部分节点通常在同一网络接口上使用多个地址
- 链路本地IPv6地址和一些全球性IPv6地址，使用接口标识符IID作为一个单播IPv6地址的分配基础
- 除了地址是以二进制000开始之外，IID在所有情况下都作为一个IPv6地址的低序位，衙门必须在同一网络中有唯一前缀
- IID的长度通常为64位，直接由一个网络接口相关的链路层MAC地址形成
  - 该地址使用修改的EUI-64格式，或者由其他进程随机提供的值形成，以提供可防范地址跟踪

- 未完



## CIDR 和 聚合







## 特殊用途地址

- | 前缀               | 特殊用途                                                     |
  | ------------------ | ------------------------------------------------------------ |
  | 0.0.0.0/8          | 本地网络中的主机，仅作为源IP地址使用                         |
  | 10.0.0.0/8         | 专用网络（内联网）的地址，不会出现在公共Internet中           |
  | 127.0.0.0/8        | Internet主机回送地址（同一个计算机），通常只用127.0.0.1      |
  | 169.254.0.0/16     | 链路本地地址，只用一条链路，通常自动分配                     |
  | 172.16.0.0/12      | 专用网络（内联网）的地址，这种地址不会出现在公共Internet中   |
  | 192.0.0.0/24       | IETF协议分配，IANA保留                                       |
  | 192.0.2.0/24       | 批准用于文档中的TEST-NET-1地址，这种地址不会出现在公共Internet中 |
  | 192.88.99.0/24     | 用于6to4中继， 任播地址                                      |
  | 192.168.0.0/16     | 专用网络（内联网）的地址，不会出现在公共Internet中           |
  | 192.18.0.0/15      | 用于基准和性能测试                                           |
  | 198.51.100.0/24    | 批准用于文档中的TEST-NET-2地址                               |
  | 203.0.113.0/24     | 批准用于文档中的TEST-NET-3地址                               |
  | 224.0.0.0/4        | IPv4 组播地址，以前的D类，仅作为目的IP地址使用               |
  | 240.0.0.0/4        | 保留空间，以前的E类，除了255.255.255.255                     |
  | 255.255.255.255/32 | 本地网络（受限）广播地址                                     |

- IPv4 和 IPv6 没有指定作为特殊、组播或保留地址的地址范围可供单播使用

- 一些单播地址空间（IPv4的前缀 10/8 、127.16/12 和 192.168/16，以及IPv6的前缀fc00::/7）被保留用于构建专用网络

  - 来自这些范围的地址可用于一个站点或组织内部的主机和路由器之间的通信，但不能跨越全球性Internet
  - 因而这些地址也称为不可路由的地址

- 专用、不可路由的地址空间管理完全由本地决定

  - IPv4专用地址在家庭网络、中等规模或大型企业内部网络中很常见
  - 经常与NAT结合使用

### 组播地址

- IPv4和IPv6支持组播寻址
- 一个IP组播地址标识一组主机接口
- 一个组可以跨越整个Internet，其所覆盖的网络部分称为组的范围
  - 节点本地（同一计算机）
  - 链路本地（同一子网）
  - 站点本地（适用于一些站点）
  - 全球（整个Internet）
  - 管理
    - 管理范围的地址可用于一个网络区域内已手动配置到路由器的地址
    - 可将路由器配置为管理范围边界，即相关组的组播流量不会被路由器转发
- 站点本地和管理 范围只在组播寻址时有效
- 当一台主机向一个组发送数据时
  - 会创建一个数据报，使用单播IP地址作为源地址，使用组播IP地址作为目的地址
  - 已加入组的所有主机将接收发送到该组的任何数据报
- 任意源组播 ASM
  - 任何发送方可以发送给任何组，一个加入组的接收方被指定唯一个组地址
- 源特定组播 SSM
  - 每个组中只使用一个信道地址，包括一个组地址和一个源IP地址
  - SSM避免了ASM部署时的复杂性



### IPv4组播地址

- | 范围                          | 特殊用途                       |
  | ----------------------------- | ------------------------------ |
  | 224.0.0.0 ~ 224.0.0.255       | 本地网络控制：不转发           |
  | 224.0.1.0 ~ 224.0.1.255       | 互联网络控制：正常转发         |
  | 224.0.2.0 ~ 224.0.2.255       | Ad hoc 块1                     |
  | 224.1.0.0 ~ 224.1.255.255     | 保留                           |
  | 224.2.0.0 ~ 224.2.255.255     | SDP/SAP                        |
  | 224.3.0.0 ~ 224.4.255.255     | Ad hoc 块2                     |
  | 224.5.0.0 ~ 224.255.255.255   | 保留                           |
  | 225.0.0.0 ~ 231.255.255.255   | 保留                           |
  | 232.0.0.0 ~ 232.255.255.255   | SSM                            |
  | 233.0.0.0 ~ 233.251.255.255   | GLOP                           |
  | 233.252.0.0 ~ 233.255.255.255 | Ad hoc 块3                     |
  | 234.0.0.0 ~ 238.255.255.255   | 基于单播前缀的IPv4组播地址保留 |
  | 239.0.0.0 ~ 239.255.255.255   | 管理范围                       |

